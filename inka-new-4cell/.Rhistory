legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 2500), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 10)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 20)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 2500), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 10)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 2700), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 10)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 2800), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 10)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 3000), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 10)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 3500), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 10)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(1,0,0,1/4), rgb(0,0,1,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 3500), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
pdf("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/AKID3/d0.pdf", width = 6, height =5)
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 3500), main = "DeepKinZero PSP 2022 Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
dev.off()
a_score<-read_csv("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA-3/top10_experiment/a_score.txt")
b_score <- read_csv("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA-3/top10_experiment/b_score.txt")
c_score<- read_csv("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA-3/top10_experiment/c_score.txt")
a_score <- as.numeric(unlist(a_score))
b_score <- as.numeric(unlist(b_score))
c_score <- as.numeric(unlist(c_score))
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 3500), main = "DeepKinZero U2OS Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 3500), main = "DeepKinZero U2OS Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 5500), main = "DeepKinZero U2OS Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 7500), main = "DeepKinZero U2OS Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 10)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 7500), main = "DeepKinZero U2OS Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 5)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
pdf("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/AKID3/d0-urea.pdf", width = 6, height =5)
hist((a_score),  col=rgb(0,0,1,1/4), ylim = c(0, 7500), main = "DeepKinZero U2OS Experiment", xlab = "AKID score",breaks = 20)
hist((b_score),  col=rgb(1,0,0,1/4), add = TRUE,breaks = 10)
hist((c_score),  col=rgb(1,1,0,1/4), add = TRUE,breaks = 5)
legend("topright", legend = c("TOP1 Probabilities", "TOP2 Probabilities","TOP3 Probabilities"), col = c(rgb(0,0,1,1/4), rgb(1,0,0,1/4),rgb(1,1,0,1/4)), pch=15, bty = "n")
dev.off()
source("https://tvpham.github.io/ion.r")
d <- ion$load("https://tvpham.github.io/data/example-3groups.txt")
source("https://tvpham.github.io/ion.r")
d <- ion$load("https://tvpham.github.io/data/example-3groups.txt")
View(d)
ion$heatmap(d)
x <- as.numeric(d[1,])
(x-mean(x))/sd(x)
head(t(scale(t(d))), n = 1)
ion$heatmap(t(d),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 5)
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
setwd("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=FALSE)
View(ink_4cell)
View(ion)
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=FALSE)
heatmap(ink_4cell)
heatmap(ion$ink_4cell)
d <- ion$load("https://tvpham.github.io/data/example-3groups.txt")
View(d)
View(ink_4cell)
ink <-mydf[, 1:ncol(ink_4cell)]
ink <-ink_4cell[, 1:ncol(ink_4cell)]
ink <-ink_4cell[, 1:ncol(ink_4cell)]
View(ink)
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=FALSE)
ion$heatmap(ink_4cell)
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=FALSE)
ion$heatmap(ink_4cell)
View(ink_4cell)
("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
source("https://tvpham.github.io/ion.r")
d <- ion$load("https://tvpham.github.io/data/example-3groups.txt")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ion$heatmap(ink_4cell)
View(ink_4cell)
View(ink_4cell)
View(d)
View(ink_4cell)
ink_4cell$H2228_1 <- as.numeric(as.character(ink_4cell$H2228_1))
print()
View(ink_4cell)
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
View(ink_4cell)
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
View(ink_4cell)
d <- ion$load("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt")
ion$heatmap(d)
View(d)
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
View(ink_4cell)
source("https://tvpham.github.io/ion.r")
d <- ion$load("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
ink_4cell$HCC827ER3_1 <- trimws(gsub('.','',ink_4cell$HCC827ER3_1,fixed=T))
ink_4cell$HCC827ER3_1 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$HCC827ER3_2 <- trimws(gsub('.','',ink_4cell$HCC827ER3_2,fixed=T))
ink_4cell$HCC827ER3_2 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$K562_1 <- trimws(gsub('.','',ink_4cell$K562_1,fixed=T))
ink_4cell$K562_1 <- as.numeric((ink_4cell$K562_1))
ink_4cell$K562_2 <- trimws(gsub('.','',ink_4cell$K562_2,fixed=T))
ink_4cell$K562_2 <- as.numeric((ink_4cell$K562_2))
ink_4cell$SKMel28_1 <- trimws(gsub('.','',ink_4cell$SKMel28_1,fixed=T))
ink_4cell$SKMel28_1 <- as.numeric((ink_4cell$SKMel28_1))
ink_4cell$SKMel28_2 <- trimws(gsub('.','',ink_4cell$SKMel28_2,fixed=T))
ink_4cell$SKMel28_2 <- as.numeric((ink_4cell$SKMel28_))
source("https://tvpham.github.io/ion.r")
d <- ion$load("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
ink_4cell$HCC827ER3_1 <- trimws(gsub('.','',ink_4cell$HCC827ER3_1,fixed=T))
ink_4cell$HCC827ER3_1 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$HCC827ER3_2 <- trimws(gsub('.','',ink_4cell$HCC827ER3_2,fixed=T))
ink_4cell$HCC827ER3_2 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$K562_1 <- trimws(gsub('.','',ink_4cell$K562_1,fixed=T))
ink_4cell$K562_1 <- as.numeric((ink_4cell$K562_1))
ink_4cell$K562_2 <- trimws(gsub('.','',ink_4cell$K562_2,fixed=T))
ink_4cell$K562_2 <- as.numeric((ink_4cell$K562_2))
ink_4cell$SKMel28_1 <- trimws(gsub('.','',ink_4cell$SKMel28_1,fixed=T))
ink_4cell$SKMel28_1 <- as.numeric((ink_4cell$SKMel28_1))
ink_4cell$SKMel28_2 <- trimws(gsub('.','',ink_4cell$SKMel28_2,fixed=T))
ink_4cell$SKMel28_2 <- as.numeric((ink_4cell$SKMel28_2))
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
d <-ink_4cell
ion$heatmap(d)
ion$heatmap(d)
x <- as.numeric(d[1,])
(x-mean(x))/sd(x)
head(t(scale(t(d))), n = 1)
ion$heatmap(t(d),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 5)
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(d,
z_transform = "none",
color = colorRampPalette(c("yellow", "green"))(32),
row_data = NULL,
col_distance = "spearman")
ion$heatmap(d,
col_color_bar = list("Subtype" = c("red", "red", "red",
"blue", "blue", "blue",
"green", "green"),
"MSI status" = c("", "",
"", "+",
"+", "+",
"+", "+")),
col_data = d,
col_distance = "spearman",
col_linkage = "ward.D2")
install.packages("heatmaply")
heatmaply(
scale(d),
xlab = "Features",
ylab = "Cars",
main = "Data Scaling"
)
library(heatmaply)
heatmaply(
scale(d),
xlab = "Features",
ylab = "Cars",
main = "Data Scaling"
)
ion$heatmap(d,
scale(d)
z_transform = "none",
ion$heatmap(scale(d),
z_transform = "none",
color = colorRampPalette(c("yellow", "green"))(32),
row_data = NULL,
col_distance = "spearman")
ion$heatmap(t(scale(d)),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 5)
ion$heatmap(t(normalize(d)),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 5)
source("https://tvpham.github.io/ion.r")
d <- ion$load("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
ink_4cell$HCC827ER3_1 <- trimws(gsub('.','',ink_4cell$HCC827ER3_1,fixed=T))
ink_4cell$HCC827ER3_1 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$HCC827ER3_2 <- trimws(gsub('.','',ink_4cell$HCC827ER3_2,fixed=T))
ink_4cell$HCC827ER3_2 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$K562_1 <- trimws(gsub('.','',ink_4cell$K562_1,fixed=T))
ink_4cell$K562_1 <- as.numeric((ink_4cell$K562_1))
ink_4cell$K562_2 <- trimws(gsub('.','',ink_4cell$K562_2,fixed=T))
ink_4cell$K562_2 <- as.numeric((ink_4cell$K562_2))
ink_4cell$SKMel28_1 <- trimws(gsub('.','',ink_4cell$SKMel28_1,fixed=T))
ink_4cell$SKMel28_1 <- as.numeric((ink_4cell$SKMel28_1))
ink_4cell$SKMel28_2 <- trimws(gsub('.','',ink_4cell$SKMel28_2,fixed=T))
ink_4cell$SKMel28_2 <- as.numeric((ink_4cell$SKMel28_2))
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
d <-ink_4cell
d <-ink_4cell
x <- as.numeric(d[1,])
(x-mean(x))/sd(x)
head(t(scale(t(d))), n = 1)
d <-ink_4cell
ion$heatmap(t((d)),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 5)
ion$heatmap(t((d)),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 15)
ion$heatmap(t((d)),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 3)
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(t(d),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(t(d[1:200,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(t(d[1:100,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(t(d[1:50,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(scale(d),
z_transform = "none",
color = colorRampPalette(c("yellow", "green"))(32),
row_data = NULL,
col_distance = "spearman")
ion$heatmap(d,
col_color_bar = list("Subtype" = c("red", "red", "red",
"blue", "blue", "blue",
"green", "green"),
"MSI status" = c("", "",
"", "+",
"+", "+",
"+", "+")),
col_data = d,
col_distance = "spearman",
col_linkage = "ward.D2")
ion$heatmap(d,
z_transform = "col",
col_data = d,
col_distance = "spearman",
col_linkage = "ward.D2")
source("https://tvpham.github.io/ion.r")
d <- ion$load("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
ink_4cell$HCC827ER3_1 <- trimws(gsub('.','',ink_4cell$HCC827ER3_1,fixed=T))
ink_4cell$HCC827ER3_1 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$HCC827ER3_2 <- trimws(gsub('.','',ink_4cell$HCC827ER3_2,fixed=T))
ink_4cell$HCC827ER3_2 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$K562_1 <- trimws(gsub('.','',ink_4cell$K562_1,fixed=T))
ink_4cell$K562_1 <- as.numeric((ink_4cell$K562_1))
ink_4cell$K562_2 <- trimws(gsub('.','',ink_4cell$K562_2,fixed=T))
ink_4cell$K562_2 <- as.numeric((ink_4cell$K562_2))
ink_4cell$SKMel28_1 <- trimws(gsub('.','',ink_4cell$SKMel28_1,fixed=T))
ink_4cell$SKMel28_1 <- as.numeric((ink_4cell$SKMel28_1))
ink_4cell$SKMel28_2 <- trimws(gsub('.','',ink_4cell$SKMel28_2,fixed=T))
ink_4cell$SKMel28_2 <- as.numeric((ink_4cell$SKMel28_2))
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
d <-ink_4cell
ion$heatmap(d)
x <- as.numeric(d[1,])
(x-mean(x))/sd(x)
head(t(scale(t(d))), n = 1)
ion$heatmap(t(d),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue", "blue",
"blue","green", "green"),
row_margin = 5)
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE)
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE,
color_key_margins = c(10, 1, 0.5, 2))
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE,
col_data = NULL,
key = FALSE)
ion$heatmap(t(d[1:20,]),
z_transform = "col",
row_labels = colnames(d),
row_label_colors = c("red", "red", "red", "blue",
"blue", "blue","green", "green"),
row_margin = 5,
cexRow = 2.5,
separator = TRUE,
key = FALSE,
col_data = NULL,
lhei = c(1, 100))
ion$heatmap(d,
z_transform = "none",
color = colorRampPalette(c("yellow", "green"))(32),
row_data = NULL,
col_distance = "spearman")
ion$heatmap(d,
z_transform = "col",
col_data = d,
col_distance = "spearman",
col_linkage = "ward.D2")
ion$heatmap(d,
z_transform = "none",
color = colorRampPalette(c("yellow", "green"))(32),
row_data = NULL,
col_distance = "spearman")
ion$heatmap(d,
z_transform = "col",
col_data = d,
col_distance = "spearman",
col_linkage = "ward.D2")
ion$heatmap(d,
col_color_bar = list("Subtype" = c("red", "red", "red",
"blue", "blue", "blue",
"green", "green"),
"MSI status" = c("", "",
"", "+",
"+", "+",
"+", "+")),
col_data = d,
col_distance = "spearman",
col_linkage = "ward.D2")
heatmap(d, scale = "row")
source("https://tvpham.github.io/ion.r")
d <- ion$load("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt")
ink_4cell <- read.delim("C:/Users/Tugce Su/OneDrive - Vrije Universiteit Amsterdam/Desktop/INKA_code/inka-4cell/InKA_20220330/ink_4cell.txt", header=TRUE)
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
ink_4cell$HCC827ER3_1 <- trimws(gsub('.','',ink_4cell$HCC827ER3_1,fixed=T))
ink_4cell$HCC827ER3_1 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$HCC827ER3_2 <- trimws(gsub('.','',ink_4cell$HCC827ER3_2,fixed=T))
ink_4cell$HCC827ER3_2 <- as.numeric((ink_4cell$HCC827ER3_1))
ink_4cell$K562_1 <- trimws(gsub('.','',ink_4cell$K562_1,fixed=T))
ink_4cell$K562_1 <- as.numeric((ink_4cell$K562_1))
ink_4cell$K562_2 <- trimws(gsub('.','',ink_4cell$K562_2,fixed=T))
ink_4cell$K562_2 <- as.numeric((ink_4cell$K562_2))
ink_4cell$SKMel28_1 <- trimws(gsub('.','',ink_4cell$SKMel28_1,fixed=T))
ink_4cell$SKMel28_1 <- as.numeric((ink_4cell$SKMel28_1))
ink_4cell$SKMel28_2 <- trimws(gsub('.','',ink_4cell$SKMel28_2,fixed=T))
ink_4cell$SKMel28_2 <- as.numeric((ink_4cell$SKMel28_2))
ink_4cell$H2228_1 <- trimws(gsub('.','',ink_4cell$H2228_1,fixed=T))
ink_4cell$H2228_1 <- as.numeric((ink_4cell$H2228_1))
ink_4cell$H2228_2 <- trimws(gsub('.','',ink_4cell$H2228_2,fixed=T))
ink_4cell$H2228_2 <- as.numeric((ink_4cell$H2228_2))
d <-ink_4cell
heatmap(d, scale = "row")
heatmap(d, scale = "column")
d <-ink_4cell
df <- scale(d)
heatmap(df, scale = "column")
heatmap(df, scale = "none")
df <- scale(d)
heatmap(df, scale = "row")
library("RColorBrewer")
col <- colorRampPalette(brewer.pal(10, "RdYlBu"))(256)
heatmap(df, scale = "none", col =  col,
RowSideColors = rep(c("blue", "pink"), each = 16),
ColSideColors = c(rep("purple", 5), rep("orange", 6)))
library("gplots")
heatmap.2(df, scale = "none", col = bluered(100),
trace = "none", density.info = "none")
library("gplots")
heatmap.2(d, scale = "none", col = bluered(100),
trace = "none", density.info = "none")
ion$heatmap(d)
library("gplots")
heatmap.2(d, scale = "none", col = bluered(100),
trace = "none", density.info = "none")
library("pheatmap")
install.packages("pheatmap")
library("pheatmap")
pheatmap(df, cutree_rows = 4)
library("pheatmap")
pheatmap(df, cutree_rows = 4)
library("pheatmap")
pheatmap(df, cutree_rows = 66)
